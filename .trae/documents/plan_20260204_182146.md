# PlugClipboard 浏览器插件开发计划

根据您的需求，我们将开发一款名为 **PlugClipboard** 的浏览器插件，具备网页内复制监听、持久化存储（20条上限）以及侧边悬浮面板查看历史记录的功能。

## 阶段一：项目初始化与配置
1.  **创建项目结构**：建立项目根目录及必要的子目录（`icons/`）。
2.  **配置清单文件** (`manifest.json`)：
    *   定义 Manifest V3 标准。
    *   声明 `storage` (存储) 和 `clipboardRead`/`clipboardWrite` (剪贴板读写) 权限。
    *   注册 Background Service Worker 和 Content Scripts。

## 阶段二：核心逻辑实现 (Backend)
1.  **编写后台服务** (`background.js`)：
    *   实现消息监听器，接收来自 Content Script 的剪贴板数据。
    *   实现数据存储逻辑：读取现有记录 -> 去重 -> 插入新记录 -> 截断至最新 20 条 -> 保存回 `chrome.storage.local`。
    *   确保数据持久化，即使浏览器重启也能保留。

## 阶段三：页面交互与监听 (Frontend Logic)
1.  **实现复制监听** (`content.js`)：
    *   监听网页的 `copy` 事件。
    *   获取选中的文本内容。
    *   发送消息给 Background 进行存储。
2.  **注入 UI 容器**：
    *   使用 Shadow DOM 创建隔离的 UI 容器，防止网页原有 CSS 干扰插件样式。

## 阶段四：UI 界面开发 (Floating UI)
1.  **开发侧边悬浮球**：
    *   设计一个简洁的侧边图标，常驻页面边缘。
    *   添加点击事件，用于切换历史面板的显示/隐藏。
2.  **开发历史记录面板**：
    *   设计抽屉式或弹窗式面板。
    *   从 `chrome.storage.local` 读取并渲染历史记录列表。
    *   **交互功能**：点击某条历史记录，将其重新复制到剪贴板，并提示“已复制”。
3.  **样式美化** (`content.css`)：
    *   编写 CSS 样式，确保界面现代、美观且不遮挡网页主要内容。

## 阶段五：验证与交付
1.  **手动测试**：
    *   加载插件到 Chrome (开发者模式)。
    *   测试复制功能（是否准确记录）。
    *   测试持久化（重启浏览器后记录是否还在）。
    *   测试 UI 交互（展开/收起，点击复制）。
2.  **交付**：
    *   确认所有功能符合预期。
    *   生成简单的使用说明。
